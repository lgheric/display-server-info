jQuery(document).ready(function ($) {

        $('#disi_enable_admin_bar, #disi_enable_widget, #disi_enable_footer').on('change', function () {

            if (typeof dISIAjaxObject !== 'undefined') {

                $('#disi-ajax-loader').show();

                var formData = $(this).closest('form').serialize();
                formData += '&nonce=' + dISIAjaxObject.nonce;

                //console.log('Form Data:', formData);
                $.ajax({
                    url: dISIAjaxObject.ajax_url,
                    type: 'POST',
                    data: formData,
                    contentType: 'application/x-www-form-urlencoded',
                    success: function (response) {
                        $('#disi-ajax-loader').hide();
                        if (response.success) {
                            showToast(dISIAjaxObject.disiLocalizeText.settingsSavedText,'default');
                        } else {
                            showToast(dISIAjaxObject.disiLocalizeText.errorOccurredText + 'ï¼š' + response.data.message,'error');
                        }
                    },
                    error: function (xhr) {
                        $('#disi-ajax-loader').hide();
                        if (xhr.status === 401) {
                            showToast(dISIAjaxObject.disiLocalizeText.loginTimeoutText,'error');
                            window.location.reload();
                        } else {
                            showToast(xhr.statusText)
                        }
                    },
                });

            }else{
                console.error('dISIAjaxObject is not defined');
            }

        });

    function showToast(message, type = 'default', duration = 2000) {
        const toast = document.createElement('div');
        toast.className = `disi-toast disi-toast-${type}`;
        toast.textContent = message;
        document.body.appendChild(toast);
        setTimeout(() => {
            toast.classList.add('fade-out');
            toast.addEventListener('transitionend', () => toast.remove());
        }, duration);
    }

});

